{"version":3,"sources":["app/pointer-lock-controls/PointerLockControls.js","app/pointer-lock-controls/index.js","app/side-drawer/list-section/styles.js","app/side-drawer/list-section/index.js","app/side-drawer/list-section/ListSection.js","state/action-types.js","state/fog/selectors.js","state/terrain/selectors.js","state/water/selectors.js","app/side-drawer/options.js","app/side-drawer/styles.js","app/side-drawer/index.js","app/side-drawer/SideDrawer.js","state/fog/actions.js","state/terrain/actions.js","state/water/actions.js","app/instructions/styles.js","app/instructions/index.js","app/instructions/Instructions.js","app/scene/params.js","app/scene/terrain/TerrainGenerator.js","shaders/noise/perlin-noise.glsl","app/scene/terrain/TerrainShaderMaterial.js","app/scene/terrain/Terrain.js","app/scene/terrain/index.js","app/scene/water/index.js","app/scene/water/Water.js","app/scene/tiles/index.js","app/scene/tiles/Tiles.js","app/scene/index.js","app/scene/Scene.js","state/terrain/reducers.js","state/fog/reducers.js","state/water/reducers.js","state/store.js","app/theme.js","app/styles.js","app/index.js","app/App.js","index.js"],"names":["extend","PointerLockControlsImpl","PointerLockControls","movementSpeed","controls","useRef","useThree","camera","domElement","gl","clock","useMemo","THREE","useState","moveForward","setMoveForward","moveBack","setMoveBack","moveLeft","setMoveLeft","moveRight","setMoveRight","moveUp","setMoveUp","moveDown","setMoveDown","useFrame","current","isLocked","delta","getDelta","distance","Number","position","y","onMouseDown","lock","onKeyDown","e","keyCode","KeyCode","onKeyUp","useEffect","addEventListener","document","removeEventListener","ref","args","defaultProps","useStyles","makeStyles","theme","listItemText","width","spacing","ListSection","memo","sectionName","optionsEnum","options","setOptions","styles","ListSubheader","map","displayName","name","min","max","step","ListItem","dense","key","ListItemText","className","Slider","component","color","valueLabelDisplay","value","onChange","TerrainAction","Object","freeze","OPTIONS","RESET_OPTIONS","FogAction","WaterAction","getFogOptions","state","fog","getTerrainOptions","terrain","getWaterOptions","water","FogOptions","TerrainOptions","WaterOptions","sideDrawer","overflowX","list","display","flexDirection","height","flexGrow","resetButton","palette","secondary","light","SideDrawer","dispatch","useDispatch","terrainOptions","useSelector","fogOptions","waterOptions","fogSetOptions","useCallback","type","setFogOptions","terrainSetOptions","setTerrainOptions","waterSetOptions","setWaterOptions","Drawer","variant","classes","paper","List","Box","button","onClick","primary","backdrop","left","zIndex","drawer","Instructions","open","setOpen","Backdrop","Typography","align","paragraph","terrainMap","process","params","lights","directional","direction","intensity","hemisphere","skyColor","groundColor","density","size","divisions","rotation","Math","PI","colorMap","colorMapScale","normalMap","displacementMap","roughnessMap","metalness","uniforms","heightMajor","spacingMajor","heightMinor","spacingMinor","tileSideLength","epsilon","TerrainGenerator","this","gpu","GPU","elevationKernel","createKernel","setDynamicOutput","setArgumentTypes","vertices","addNativeFunction","numVertices","setOutput","TerrainShaderMaterial","props","side","sceneParams","textureLoader","load","wrapS","wrapT","repeat","set","updateMatrix","normalMapType","Terrain","tileOffsets","numTiles","tiles","Array","keys","planes","createRef","terrainGenerator","context","getContext","maxTextureSize","getParameter","MAX_TEXTURE_SIZE","forEach","offset","offsetIndex","geometry","vertexBatchSize","length","i","vertexBatch","slice","terrainElevations","generateElevation","v","x","vertex","index","setZ","verticesNeedUpdate","String","attach","Water","transparent","transparency","Tiles","sideLength","tileSize","tileX","floor","tileY","newTiles","j","push","prev","next","Scene","getOffsets","setTileOffsets","z","newTileOffsets","offsetsAreEqual","initialState","action","update","$set","store","compose","applyMiddleware","createStore","combineReducers","createMuiTheme","app","canvas","background","stats","top","right","bottom","marginRight","marginBottom","App","ThemeProvider","gl2","makeDefault","logger","useDefaults","formatter","messages","unshift","level","RootComponent","WEBGL","isWebGL2Available","getWebGL2ErrorMessage","textContent","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.87050027.chunk.js","sourcesContent":["import React, {\n  useMemo,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\nimport { extend, useFrame, useThree } from 'react-three-fiber';\nimport * as THREE from 'three';\nimport { PointerLockControls as PointerLockControlsImpl }\n  from 'three/examples/jsm/controls/PointerLockControls';\nimport * as KeyCode from 'keycode-js';\nimport PropTypes from 'prop-types';\n\nextend({ PointerLockControlsImpl });\n\nconst PointerLockControls = ({ movementSpeed }) => {\n  const controls = useRef();\n  const { camera, gl: { domElement } } = useThree();\n  const clock = useMemo(() => new THREE.Clock(), []);\n\n  const [moveForward, setMoveForward] = useState(false);\n  const [moveBack, setMoveBack] = useState(false);\n  const [moveLeft, setMoveLeft] = useState(false);\n  const [moveRight, setMoveRight] = useState(false);\n  const [moveUp, setMoveUp] = useState(false);\n  const [moveDown, setMoveDown] = useState(false);\n\n  useFrame(() => {\n    if (!controls.current.isLocked) {\n      return;\n    }\n\n    const delta = clock.getDelta();\n\n    if (moveForward || moveBack) {\n      const distance = (Number(moveForward) - Number(moveBack)) * delta * movementSpeed;\n      controls.current.moveForward(distance);\n    }\n    if (moveLeft || moveRight) {\n      const distance = (Number(moveRight) - Number(moveLeft)) * delta * movementSpeed;\n      controls.current.moveRight(distance);\n    }\n    if (moveUp || moveDown) {\n      const distance = (Number(moveUp) - Number(moveDown)) * delta * movementSpeed;\n      camera.position.y += distance;\n    }\n  });\n\n  const onMouseDown = () => {\n    controls.current.lock();\n  };\n\n  const onKeyDown = (e) => {\n    switch (e.keyCode) {\n      case KeyCode.KEY_W:\n        setMoveForward(true);\n        break;\n      case KeyCode.KEY_S:\n        setMoveBack(true);\n        break;\n      case KeyCode.KEY_A:\n        setMoveLeft(true);\n        break;\n      case KeyCode.KEY_D:\n        setMoveRight(true);\n        break;\n      case KeyCode.KEY_SPACE:\n        setMoveUp(true);\n        break;\n      case KeyCode.KEY_SHIFT:\n        setMoveDown(true);\n        break;\n      default:\n        break;\n    }\n  };\n\n  const onKeyUp = (e) => {\n    switch (e.keyCode) {\n      case KeyCode.KEY_W:\n        setMoveForward(false);\n        break;\n      case KeyCode.KEY_S:\n        setMoveBack(false);\n        break;\n      case KeyCode.KEY_A:\n        setMoveLeft(false);\n        break;\n      case KeyCode.KEY_D:\n        setMoveRight(false);\n        break;\n      case KeyCode.KEY_SPACE:\n        setMoveUp(false);\n        break;\n      case KeyCode.KEY_SHIFT:\n        setMoveDown(false);\n        break;\n      default:\n        break;\n    }\n  };\n\n  useEffect(() => {\n    domElement.addEventListener('mousedown', onMouseDown, false);\n    document.addEventListener('keydown', onKeyDown, false);\n    document.addEventListener('keyup', onKeyUp, false);\n\n    return () => {\n      domElement.removeEventListener('mousedown', onMouseDown, false);\n      document.removeEventListener('keydown', onKeyDown, false);\n      document.removeEventListener('keyup', onKeyUp, false);\n    };\n  }, [domElement]);\n\n  return (\n    <pointerLockControlsImpl\n      ref={controls}\n      args={[camera, domElement]}\n    />\n  );\n};\n\nPointerLockControls.defaultProps = {\n  movementSpeed: 5,\n};\n\nPointerLockControls.propTypes = {\n  movementSpeed: PropTypes.number,\n};\n\nexport default PointerLockControls;\n","import PointerLockControls from './PointerLockControls';\n\nexport default PointerLockControls;\n","import { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles((theme) => ({\n  listItemText: {\n    width: theme.spacing(25),\n  },\n}));\n\nexport default useStyles;\n","import ListSection from './ListSection';\n\nexport default ListSection;\n","import React, { memo } from 'react';\nimport PropTypes from 'prop-types';\nimport {\n  ListItem,\n  ListItemText,\n  ListSubheader,\n  Slider,\n} from '@material-ui/core';\n\nimport useStyles from './styles';\n\n// Side panel on left\nconst ListSection = ({\n  sectionName,\n  optionsEnum,\n  options,\n  setOptions,\n}) => {\n  const styles = useStyles();\n\n  return (\n    <>\n      <ListSubheader>{ sectionName }</ListSubheader>\n      {\n        optionsEnum.map(({\n          displayName,\n          name,\n          min,\n          max,\n          step,\n        }) => (\n          <ListItem dense key={name}>\n            <ListItemText className={styles.listItemText}>{ displayName }</ListItemText>\n            <Slider\n              component=\"div\"\n              color=\"secondary\"\n              min={min}\n              max={max}\n              step={step}\n              valueLabelDisplay=\"auto\"\n              value={options[name]}\n              onChange={(e, value) => setOptions(name, value)}\n            />\n          </ListItem>\n        ))\n      }\n    </>\n  );\n};\n\nListSection.propTypes = {\n  sectionName: PropTypes.string.isRequired,\n  optionsEnum: PropTypes.arrayOf(PropTypes.shape({\n    displayName: PropTypes.string.isRequired,\n    name: PropTypes.string.isRequired,\n    min: PropTypes.number.isRequired,\n    max: PropTypes.number.isRequired,\n    step: PropTypes.number.isRequired,\n  })).isRequired,\n  options: PropTypes.objectOf(PropTypes.number).isRequired,\n  setOptions: PropTypes.func.isRequired,\n};\n\nexport default memo(ListSection);\n","/*\n * Enums for action types\n * Action type strings should be unique across enums since all reducers\n * are combined\n * Convention: ActionGroup_UNIQUE_LABEL\n */\n\nexport const TerrainAction = Object.freeze({\n  OPTIONS: 'TerrainAction_OPTIONS',\n  RESET_OPTIONS: 'TerrainAction_RESET_OPTIONS',\n});\n\nexport const FogAction = Object.freeze({\n  OPTIONS: 'FogAction_OPTIONS',\n  RESET_OPTIONS: 'FogAction_RESET_OPTIONS',\n});\n\nexport const WaterAction = Object.freeze({\n  OPTIONS: 'WaterAction_OPTIONS',\n  RESET_OPTIONS: 'WaterAction_RESET_OPTIONS',\n});\n","// eslint-disable-next-line import/prefer-default-export\nexport const getFogOptions = (state) => state.fog.options;\n","// eslint-disable-next-line import/prefer-default-export\nexport const getTerrainOptions = (state) => state.terrain.options;\n","// eslint-disable-next-line import/prefer-default-export\nexport const getWaterOptions = (state) => state.water.options;\n","export const FogOptions = [\n  {\n    displayName: 'Density',\n    name: 'density',\n    min: 0,\n    max: 0.5,\n    step: 0.001,\n  },\n];\n\nexport const TerrainOptions = [\n  {\n    displayName: 'Height Major',\n    name: 'heightMajor',\n    min: 0,\n    max: 10,\n    step: 0.1,\n  },\n  {\n    displayName: 'Spacing Major',\n    name: 'spacingMajor',\n    min: 0,\n    max: 1.0,\n    step: 0.01,\n  },\n  {\n    displayName: 'Height Minor',\n    name: 'heightMinor',\n    min: 0,\n    max: 1,\n    step: 0.01,\n  },\n  {\n    displayName: 'Spacing Minor',\n    name: 'spacingMinor',\n    min: 0,\n    max: 5.0,\n    step: 0.05,\n  },\n];\n\nexport const WaterOptions = [\n  {\n    displayName: 'Height',\n    name: 'height',\n    min: -5,\n    max: 5,\n    step: 0.1,\n  },\n];\n","import { makeStyles } from '@material-ui/core/styles';\n\nexport const SIDE_DRAWER_WIDTH = '20%';\n\nconst useStyles = makeStyles((theme) => ({\n  sideDrawer: {\n    width: SIDE_DRAWER_WIDTH,\n    overflowX: 'hidden',\n  },\n  list: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%',\n  },\n  options: {\n    flexGrow: 1,\n  },\n  resetButton: {\n    color: theme.palette.secondary.light,\n  },\n}));\n\nexport default useStyles;\n","import SideDrawer from './SideDrawer';\n\nexport default SideDrawer;\n","import React, { useCallback, memo } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport {\n  Box,\n  Drawer,\n  List,\n  ListItem,\n  ListItemText,\n} from '@material-ui/core';\n\nimport ListSection from 'app/side-drawer/list-section';\nimport { resetFogOptions, setFogOptions } from 'state/fog/actions';\nimport { resetTerrainOptions, setTerrainOptions } from 'state/terrain/actions';\nimport { resetWaterOptions, setWaterOptions } from 'state/water/actions';\nimport { getFogOptions } from 'state/fog/selectors';\nimport { getTerrainOptions } from 'state/terrain/selectors';\nimport { getWaterOptions } from 'state/water/selectors';\nimport { FogOptions, TerrainOptions, WaterOptions } from 'app/side-drawer/options';\n\nimport useStyles from './styles';\n\n// Side panel on left\nconst SideDrawer = () => {\n  const styles = useStyles();\n  const dispatch = useDispatch();\n\n  const resetAll = () => {\n    dispatch(resetFogOptions());\n    dispatch(resetTerrainOptions());\n    dispatch(resetWaterOptions());\n  };\n\n  const terrainOptions = useSelector(getTerrainOptions);\n  const fogOptions = useSelector(getFogOptions);\n  const waterOptions = useSelector(getWaterOptions);\n\n  const fogSetOptions = useCallback((name, value) => dispatch(\n    setFogOptions(name, value),\n  ), [dispatch]);\n\n  const terrainSetOptions = useCallback((name, value) => dispatch(\n    setTerrainOptions(name, value),\n  ), [dispatch]);\n\n  const waterSetOptions = useCallback((name, value) => dispatch(\n    setWaterOptions(name, value),\n  ), [dispatch]);\n\n  return (\n    <Drawer\n      className={styles.sideDrawer}\n      variant=\"permanent\"\n      classes={{\n        paper: styles.sideDrawer,\n      }}\n    >\n      <List className={styles.list}>\n        <Box className={styles.options}>\n          <ListSection\n            sectionName=\"Fog\"\n            optionsEnum={FogOptions}\n            options={fogOptions}\n            setOptions={fogSetOptions}\n          />\n          <ListSection\n            sectionName=\"Terrain\"\n            optionsEnum={TerrainOptions}\n            options={terrainOptions}\n            setOptions={terrainSetOptions}\n          />\n          <ListSection\n            sectionName=\"Water\"\n            optionsEnum={WaterOptions}\n            options={waterOptions}\n            setOptions={waterSetOptions}\n          />\n        </Box>\n        <ListItem\n          button\n          dense\n          onClick={resetAll}\n        >\n          <ListItemText\n            primary=\"Reset all\"\n            classes={{\n              primary: styles.resetButton,\n            }}\n          />\n        </ListItem>\n      </List>\n    </Drawer>\n  );\n};\n\nexport default memo(SideDrawer);\n","import { FogAction } from 'state/action-types';\n\nexport const setFogOptions = (name, value) => ({\n  type: FogAction.OPTIONS,\n  name,\n  value,\n});\n\nexport const resetFogOptions = () => ({\n  type: FogAction.RESET_OPTIONS,\n});\n","import { TerrainAction } from 'state/action-types';\n\nexport const setTerrainOptions = (name, value) => ({\n  type: TerrainAction.OPTIONS,\n  name,\n  value,\n});\n\nexport const resetTerrainOptions = () => ({\n  type: TerrainAction.RESET_OPTIONS,\n});\n","import { WaterAction } from 'state/action-types';\n\nexport const setWaterOptions = (name, value) => ({\n  type: WaterAction.OPTIONS,\n  name,\n  value,\n});\n\nexport const resetWaterOptions = () => ({\n  type: WaterAction.RESET_OPTIONS,\n});\n","import { makeStyles } from '@material-ui/core/styles';\nimport { SIDE_DRAWER_WIDTH } from 'app/side-drawer/styles';\n\nconst useStyles = makeStyles((theme) => ({\n  backdrop: {\n    width: `calc(100% - ${SIDE_DRAWER_WIDTH})`,\n    left: SIDE_DRAWER_WIDTH,\n    zIndex: theme.zIndex.drawer,\n  },\n}));\n\nexport default useStyles;\n","import Instructions from './Instructions';\n\nexport default Instructions;\n","import React, { useState } from 'react';\nimport { Backdrop, Typography } from '@material-ui/core';\nimport useStyles from './styles';\n\nconst Instructions = () => {\n  const styles = useStyles();\n\n  const [open, setOpen] = useState(true);\n\n  return (\n    <Backdrop\n      className={styles.backdrop}\n      open={open}\n      onClick={() => setOpen(false)}\n    >\n      <div>\n        <Typography\n          variant=\"h3\"\n          color=\"textPrimary\"\n          align=\"center\"\n          paragraph\n        >\n          Terrene\n        </Typography>\n        <Typography\n          variant=\"body1\"\n          color=\"textPrimary\"\n          align=\"center\"\n        >\n          Move: WASD\n        </Typography>\n        <Typography\n          variant=\"body1\"\n          color=\"textPrimary\"\n          align=\"center\"\n        >\n          Ascend/Descend: Space/Shift\n        </Typography>\n        <Typography\n          variant=\"body1\"\n          color=\"textPrimary\"\n          align=\"center\"\n        >\n          Enable/Disable Controls: Click/Esc\n        </Typography>\n      </div>\n    </Backdrop>\n  );\n};\n\nexport default Instructions;\n","const terrainMap = (type) => (\n  `${process.env.PUBLIC_URL}/assets/aerial_grass_rock/aerial_grass_rock_${type}_2k.jpg`\n);\n\nconst params = Object.freeze({\n  camera: {\n    position: [0, 1, 2.5],\n    movementSpeed: 5,\n  },\n  lights: {\n    directional: [\n      {\n        direction: [0, 1, 0],\n        intensity: 0.75,\n      },\n    ],\n    hemisphere: {\n      skyColor: 'lightblue',\n      groundColor: 'brown',\n      intensity: 0.2,\n    },\n  },\n  fog: {\n    color: 'lightgrey',\n    density: 0.05,\n  },\n  terrain: {\n    size: 25,\n    divisions: 80,\n    position: [0, 0, 0],\n    rotation: [-Math.PI / 2, 0, 0],\n    colorMap: terrainMap('diff'),\n    colorMapScale: [10, 10],\n    normalMap: terrainMap('nor'),\n    displacementMap: terrainMap('disp'),\n    roughnessMap: terrainMap('rough'),\n    metalness: 0.5,\n    uniforms: {\n      heightMajor: 3.0,\n      spacingMajor: 0.25,\n      heightMinor: 0.3,\n      spacingMinor: 1.25,\n    },\n  },\n  water: {\n    uniforms: {\n      height: -0.3,\n    },\n  },\n  tileSideLength: 3,\n  epsilon: 1e-7,\n});\n\nexport default params;\n","import { GPU } from 'gpu.js';\n\nimport perlinNoiseShader from 'shaders/noise/perlin-noise.glsl';\n\nclass TerrainGenerator {\n  constructor() {\n    this.gpu = new GPU();\n\n    this.elevationKernel = this.gpu.createKernel(`function (\n      vertices, position, heightMajor, spacingMajor, heightMinor, spacingMinor,\n    ) {\n      const vertex = vertices[this.thread.x];\n      const x = vertex[0] + position[0];\n      const z = vertex[1] + position[1];\n\n      let elevation = 0.0;\n      /* eslint-disable no-undef */\n      elevation += heightMajor * perlinNoise([x * spacingMajor, z * spacingMajor]);\n      elevation += heightMinor * perlinNoise([x * spacingMinor, z * spacingMinor]);\n      /* eslint-enable no-undef */\n      return elevation;\n    }`)\n      .setDynamicOutput(true)\n      .setArgumentTypes({\n        vertices: 'Array1D(2)',\n        position: 'Array(2)',\n        heightMajor: 'Float',\n        spacingMajor: 'Float',\n        heightMinor: 'Float',\n        spacingMinor: 'Float',\n      })\n      .addNativeFunction('perlinNoise', perlinNoiseShader);\n  }\n\n  generateElevation(\n    vertices, numVertices, position, heightMajor, spacingMajor, heightMinor, spacingMinor,\n  ) {\n    this.elevationKernel.setOutput([numVertices]);\n    return this.elevationKernel(\n      vertices, position, heightMajor, spacingMajor, heightMinor, spacingMinor,\n    );\n  }\n}\n\nexport default TerrainGenerator;\n","export default \"#define GLSLIFY 1\\n//\\tClassic Perlin 2D Noise \\n//\\tby Stefan Gustavson\\n//  https://gist.github.com/patriciogonzalezvivo/670c22f3966e662d2f83\\n\\n// Make sure perlin noise is the first function, so we can use it GPU.js\\nfloat perlinNoise(vec2 P);\\n\\nvec4 permute(vec4 x) {\\n  return mod((x * 34.0 + 1.0) * x, 289.0);\\n}\\n\\nvec2 fade(vec2 t) {\\n  return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);\\n}\\n\\nfloat perlinNoise(vec2 P) {\\n  vec4 Pi = floor(P.xyxy) + vec4(0.0, 0.0, 1.0, 1.0);\\n  vec4 Pf = fract(P.xyxy) - vec4(0.0, 0.0, 1.0, 1.0);\\n  Pi = mod(Pi, 289.0); // To avoid truncation effects in permutation\\n  vec4 ix = Pi.xzxz;\\n  vec4 iy = Pi.yyww;\\n  vec4 fx = Pf.xzxz;\\n  vec4 fy = Pf.yyww;\\n  vec4 i = permute(permute(ix) + iy);\\n  vec4 gx = 2.0 * fract(i * 0.0243902439) - 1.0; // 1/41 = 0.024...\\n  vec4 gy = abs(gx) - 0.5;\\n  vec4 tx = floor(gx + 0.5);\\n  gx = gx - tx;\\n  vec2 g00 = vec2(gx.x,gy.x);\\n  vec2 g10 = vec2(gx.y,gy.y);\\n  vec2 g01 = vec2(gx.z,gy.z);\\n  vec2 g11 = vec2(gx.w,gy.w);\\n  vec4 norm = 1.79284291400159 - 0.85373472095314 * \\n    vec4(dot(g00, g00), dot(g01, g01), dot(g10, g10), dot(g11, g11));\\n  g00 *= norm.x;\\n  g01 *= norm.y;\\n  g10 *= norm.z;\\n  g11 *= norm.w;\\n  float n00 = dot(g00, vec2(fx.x, fy.x));\\n  float n10 = dot(g10, vec2(fx.y, fy.y));\\n  float n01 = dot(g01, vec2(fx.z, fy.z));\\n  float n11 = dot(g11, vec2(fx.w, fy.w));\\n  vec2 fade_xy = fade(Pf.xy);\\n  vec2 n_x = mix(vec2(n00, n01), vec2(n10, n11), fade_xy.x);\\n  float n_xy = mix(n_x.x, n_x.y, fade_xy.y);\\n  return 2.3 * n_xy;\\n}\\n\\n\";","import * as THREE from 'three';\n\nimport sceneParams from 'app/scene/params';\n\nclass TerrainShaderMaterial extends THREE.MeshStandardMaterial {\n  constructor(props) {\n    super({\n      ...props,\n      side: THREE.DoubleSide,\n    });\n\n    const { terrain } = sceneParams;\n\n    const textureLoader = new THREE.TextureLoader();\n\n    const colorMap = textureLoader.load(terrain.colorMap);\n    colorMap.wrapS = THREE.RepeatWrapping;\n    colorMap.wrapT = THREE.RepeatWrapping;\n    colorMap.repeat.set(...terrain.colorMapScale);\n    colorMap.updateMatrix();\n\n    const normalMap = textureLoader.load(terrain.normalMap);\n    normalMap.wrapS = THREE.RepeatWrapping;\n    normalMap.wrapT = THREE.RepeatWrapping;\n\n    const displacementMap = textureLoader.load(terrain.displacementMap);\n    displacementMap.wrapS = THREE.RepeatWrapping;\n    displacementMap.wrapT = THREE.RepeatWrapping;\n\n    const roughnessMap = textureLoader.load(terrain.roughnessMap);\n    roughnessMap.wrapS = THREE.RepeatWrapping;\n    roughnessMap.wrapT = THREE.RepeatWrapping;\n\n    this.map = colorMap;\n    this.normalMap = normalMap;\n    this.normalMapType = THREE.TangentSpaceNormalMap;\n    this.displacementMap = displacementMap;\n    this.roughnessMap = roughnessMap;\n    this.metalness = terrain.metalness;\n  }\n}\n\nexport default TerrainShaderMaterial;\n","import React, {\n  useMemo,\n  useEffect,\n  useRef,\n  createRef,\n  memo,\n} from 'react';\nimport { useSelector } from 'react-redux';\nimport { useThree, extend } from 'react-three-fiber';\nimport PropTypes from 'prop-types';\n\nimport sceneParams from 'app/scene/params';\nimport TerrainGenerator from 'app/scene/terrain/TerrainGenerator';\nimport TerrainShaderMaterial from 'app/scene/terrain/TerrainShaderMaterial';\nimport { getTerrainOptions } from 'state/terrain/selectors';\n\nextend({ TerrainShaderMaterial });\n\nconst Terrain = ({ tileOffsets, numTiles }) => {\n  const tiles = useMemo(() => [...new Array(numTiles).keys()], [numTiles]);\n  const planes = useRef(tiles.map(() => createRef()));\n  const { gl } = useThree();\n  const { terrain } = sceneParams;\n\n  const terrainGenerator = useMemo(() => new TerrainGenerator(), []);\n  const terrainOptions = useSelector(getTerrainOptions);\n\n  useEffect(() => {\n    const context = gl.getContext();\n    const maxTextureSize = context.getParameter(context.MAX_TEXTURE_SIZE);\n\n    tileOffsets.forEach((offset, offsetIndex) => {\n      const { position, geometry, geometry: { vertices } } = planes.current[offsetIndex].current;\n      position.set(...offset, 0);\n\n      const vertexBatchSize = Math.min(maxTextureSize, vertices.length);\n\n      for (let i = 0; i < vertices.length; i += vertexBatchSize) {\n        const vertexBatch = vertices.slice(i, i + vertexBatchSize);\n        const terrainElevations = terrainGenerator.generateElevation(\n          vertexBatch.map((v) => [v.x, v.y]),\n          vertexBatch.length,\n          offset,\n          terrainOptions.heightMajor,\n          terrainOptions.spacingMajor,\n          terrainOptions.heightMinor,\n          terrainOptions.spacingMinor,\n        );\n        vertexBatch.forEach((vertex, index) => vertex.setZ(terrainElevations[index]));\n      }\n      geometry.verticesNeedUpdate = true;\n    });\n  }, [gl, terrainGenerator, terrainOptions, tileOffsets]);\n\n  return (\n    <group rotation={terrain.rotation}>\n      {\n        tiles.map((value, index) => (\n          <mesh\n            ref={planes.current[index]}\n            key={String(value)}\n          >\n            <planeGeometry\n              attach=\"geometry\"\n              args={[terrain.size, terrain.size, terrain.divisions, terrain.divisions]}\n            />\n            <terrainShaderMaterial attach=\"material\" />\n          </mesh>\n        ))\n      }\n    </group>\n  );\n};\n\nTerrain.propTypes = {\n  tileOffsets: PropTypes.arrayOf(PropTypes.arrayOf(PropTypes.number)).isRequired,\n  numTiles: PropTypes.number.isRequired,\n};\n\nexport default memo(Terrain);\n","import Terrain from './Terrain';\n\nexport default Terrain;\n","import Water from './Water';\n\nexport default Water;\n","import React, {\n  useMemo,\n  useEffect,\n  useRef,\n  createRef,\n  memo,\n} from 'react';\nimport { useSelector } from 'react-redux';\nimport * as THREE from 'three';\nimport PropTypes from 'prop-types';\n\nimport sceneParams from 'app/scene/params';\nimport { getWaterOptions } from 'state/water/selectors';\n\nconst Water = ({ tileOffsets, numTiles }) => {\n  const tiles = useMemo(() => [...new Array(numTiles).keys()], [numTiles]);\n  const planes = useRef(tiles.map(() => createRef()));\n  const { terrain } = sceneParams;\n\n  const waterOptions = useSelector(getWaterOptions);\n\n  useEffect(() => {\n    tileOffsets.forEach((offset, index) => {\n      const { position } = planes.current[index].current;\n      position.set(...offset, waterOptions.height);\n    });\n  }, [tileOffsets, waterOptions.height]);\n\n  return (\n    <group rotation={terrain.rotation}>\n      {\n        tiles.map((value, index) => (\n          <mesh\n            ref={planes.current[index]}\n            key={String(value)}\n          >\n            <planeGeometry\n              attach=\"geometry\"\n              args={[terrain.size, terrain.size, 1, 1]}\n            />\n            <meshPhysicalMaterial\n              attach=\"material\"\n              color=\"lightblue\"\n              side={THREE.DoubleSide}\n              transparent\n              transparency={0.5}\n              metalness={0}\n            />\n          </mesh>\n        ))\n      }\n    </group>\n  );\n};\n\nWater.propTypes = {\n  tileOffsets: PropTypes.arrayOf(PropTypes.arrayOf(PropTypes.number)).isRequired,\n  numTiles: PropTypes.number.isRequired,\n};\n\nexport default memo(Water);\n","import Tiles from './Tiles';\n\nexport default Tiles;\n","class Tiles {\n  constructor(sideLength, tileSize) {\n    this.sideLength = sideLength;\n    this.tileSize = tileSize;\n    this.numTiles = sideLength ** 2;\n  }\n\n  static offsetsAreEqual(prev, next) {\n    for (let i = 0; i < 9; i += 1) {\n      for (let j = 0; j < 2; j += 1) {\n        if (prev[i][j] !== next[i][j]) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n\n  getOffsets(x, y) {\n    const tileX = Math.floor(x / this.tileSize) * this.tileSize;\n    const tileY = Math.floor(y / this.tileSize) * this.tileSize;\n\n    const newTiles = [];\n\n    for (let i = -this.sideLength / 2; i < this.sideLength / 2; i += 1) {\n      for (let j = -this.sideLength / 2; j < this.sideLength / 2; j += 1) {\n        newTiles.push([tileX + j * this.tileSize, tileY + i * this.tileSize]);\n      }\n    }\n\n    return newTiles;\n  }\n}\n\nexport default Tiles;\n","import Scene from './Scene';\n\nexport default Scene;\n","import React, { memo, useState, useMemo } from 'react';\nimport { useSelector } from 'react-redux';\nimport { useThree, useFrame } from 'react-three-fiber';\n\nimport sceneParams from 'app/scene/params';\nimport Terrain from 'app/scene/terrain';\nimport Water from 'app/scene/water';\nimport { getFogOptions } from 'state/fog/selectors';\nimport Tiles from 'app/scene/tiles';\n\nconst Scene = () => {\n  const { camera } = useThree();\n  const { terrain, lights: { hemisphere, directional }, tileSideLength } = sceneParams;\n\n  const fogOptions = useSelector(getFogOptions);\n\n  const tiles = useMemo(() => new Tiles(tileSideLength, terrain.size),\n    [tileSideLength, terrain.size]);\n  const [tileOffsets, setTileOffsets] = useState(tiles.getOffsets(0, 0));\n\n  useFrame(() => {\n    const { position } = camera;\n    const x = position.x + terrain.size / 2;\n    const y = -position.z + terrain.size / 2;\n\n    const newTileOffsets = tiles.getOffsets(x, y);\n    if (!Tiles.offsetsAreEqual(newTileOffsets, tileOffsets)) {\n      setTileOffsets(newTileOffsets);\n    }\n  });\n\n  return (\n    <>\n      <hemisphereLight\n        args={[hemisphere.skyColor, hemisphere.groundColor, hemisphere.intensity]}\n      />\n      {\n        directional.map(({ direction, intensity }) => (\n          <directionalLight\n            direction={direction}\n            intensity={intensity}\n            key={`${direction}-${intensity}`}\n          />\n        ))\n      }\n      <fogExp2\n        attach=\"fog\"\n        args={[fogOptions.color, fogOptions.density]}\n      />\n      <Terrain tileOffsets={tileOffsets} numTiles={tiles.numTiles} />\n      <Water tileOffsets={tileOffsets} numTiles={tiles.numTiles} />\n    </>\n  );\n};\n\nexport default memo(Scene);\n","import update from 'immutability-helper';\n\nimport { TerrainAction } from 'state/action-types';\nimport sceneParams from 'app/scene/params';\nimport { TerrainOptions } from 'app/side-drawer/options';\n\nconst initialState = {\n  options: {},\n};\n\nTerrainOptions.forEach(({ name }) => {\n  initialState.options[name] = sceneParams.terrain.uniforms[name];\n});\n\nconst terrain = (state = initialState, action) => {\n  switch (action.type) {\n    case TerrainAction.OPTIONS:\n      return update(state, {\n        options: {\n          [action.name]: { $set: action.value },\n        },\n      });\n    case TerrainAction.RESET_OPTIONS:\n      return {\n        ...state,\n        options: initialState.options,\n      };\n    default:\n      return state;\n  }\n};\n\nexport default terrain;\n","import update from 'immutability-helper';\n\nimport { FogAction } from 'state/action-types';\nimport sceneParams from 'app/scene/params';\nimport { FogOptions } from 'app/side-drawer/options';\n\nconst initialState = {\n  options: {},\n};\n\nFogOptions.forEach(({ name }) => {\n  initialState.options[name] = sceneParams.fog[name];\n});\n\nconst fog = (state = initialState, action) => {\n  switch (action.type) {\n    case FogAction.OPTIONS:\n      return update(state, {\n        options: {\n          [action.name]: { $set: action.value },\n        },\n      });\n    case FogAction.RESET_OPTIONS:\n      return {\n        ...state,\n        options: initialState.options,\n      };\n    default:\n      return state;\n  }\n};\n\nexport default fog;\n","import update from 'immutability-helper';\n\nimport { WaterAction } from 'state/action-types';\nimport sceneParams from 'app/scene/params';\nimport { WaterOptions } from 'app/side-drawer/options';\n\nconst initialState = {\n  options: {},\n};\n\nWaterOptions.forEach(({ name }) => {\n  initialState.options[name] = sceneParams.water.uniforms[name];\n});\n\nconst water = (state = initialState, action) => {\n  switch (action.type) {\n    case WaterAction.OPTIONS:\n      return update(state, {\n        options: {\n          [action.name]: { $set: action.value },\n        },\n      });\n    case WaterAction.RESET_OPTIONS:\n      return {\n        ...state,\n        options: initialState.options,\n      };\n    default:\n      return state;\n  }\n};\n\nexport default water;\n","import {\n  combineReducers,\n  createStore,\n  compose,\n  applyMiddleware,\n} from 'redux';\nimport { createLogger } from 'redux-logger';\n\nimport terrain from 'state/terrain/reducers';\nimport fog from 'state/fog/reducers';\nimport water from 'state/water/reducers';\n\nconst middlewares = [];\n\nif (process.env.NODE_ENV === 'development') {\n  // Log redux updates to console if env var `REACT_APP_REDUX_LOGGER` is set\n  if (process.env.REACT_APP_REDUX_LOGGER) {\n    const reduxLogger = createLogger({\n      duration: true,\n      diff: true,\n    });\n    middlewares.push(reduxLogger);\n  }\n}\n\nconst store = compose(applyMiddleware(...middlewares))(createStore)(\n  combineReducers({\n    terrain,\n    fog,\n    water,\n  }),\n);\n\nexport default store;\n","import { createMuiTheme } from '@material-ui/core/styles';\n\nconst theme = createMuiTheme({\n  palette: {\n    type: 'dark',\n  },\n});\n\nexport default theme;\n","import { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles((theme) => ({\n  app: {\n    display: 'flex',\n    height: '100%',\n  },\n  canvas: {\n    background: 'lightgrey',\n  },\n  stats: {\n    left: 'auto !important',\n    top: 'auto !important',\n    right: '0px !important',\n    bottom: '0px !important',\n    marginRight: theme.spacing(1),\n    marginBottom: theme.spacing(1),\n  },\n}));\n\nexport default useStyles;\n","import App from './App';\n\nexport default App;\n","import React from 'react';\nimport { Box } from '@material-ui/core';\nimport { ThemeProvider } from '@material-ui/core/styles';\nimport { Provider } from 'react-redux';\nimport { Canvas } from 'react-three-fiber';\nimport { PerspectiveCamera, Stats } from 'drei';\nimport PointerLockControls from 'app/pointer-lock-controls';\n\nimport SideDrawer from 'app/side-drawer';\nimport Instructions from 'app/instructions';\nimport Scene from 'app/scene';\nimport sceneParams from 'app/scene/params';\nimport store from 'state/store';\n\nimport theme from './theme';\nimport useStyles from './styles';\n\nconst App = () => {\n  const styles = useStyles();\n\n  return (\n    <Box className={styles.app}>\n      <ThemeProvider theme={theme}>\n        <SideDrawer />\n        <Instructions />\n        <Canvas\n          className={styles.canvas}\n          gl2\n        >\n          <Stats className={styles.stats} />\n          <Provider store={store}>\n            <PointerLockControls\n              movementSpeed={sceneParams.camera.movementSpeed}\n            />\n            <PerspectiveCamera\n              position={sceneParams.camera.position}\n              makeDefault\n            />\n            <Scene />\n          </Provider>\n        </Canvas>\n      </ThemeProvider>\n    </Box>\n  );\n};\n\nexport default App;\n","import 'wdyr';\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport logger from 'js-logger';\nimport { WEBGL } from 'three/examples/jsm/WebGL';\n\nimport App from 'app';\nimport store from 'state/store';\n\nimport './index.css';\n\n// Set up logger that prints log level at the beginning of all messages\nlogger.useDefaults({\n  formatter: (messages, context) => {\n    messages.unshift(`${context.level.name}`);\n  },\n});\n\nconst RootComponent = () => {\n  // WebGL 2 is required - fail to load the app if not available\n  if (!WEBGL.isWebGL2Available()) {\n    return <>{ WEBGL.getWebGL2ErrorMessage().textContent }</>;\n  }\n\n  return (\n    <Provider store={store}>\n      <App />\n    </Provider>\n  );\n};\n\nReactDOM.render(\n  <RootComponent />,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}